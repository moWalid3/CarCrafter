import{a as p}from"./chunk-KE5EG2OL.js";import{Aa as d,Pc as g,Rc as f,_ as c,aa as b,ga as u,pb as o,ra as y}from"./chunk-YVS74DTD.js";function h(a,i){let l=!i?.manualCleanup;l&&!i?.injector&&y(h);let r=l?i?.injector?.get(d)??u(d):null,e=C(i?.equal),t;i?.requireSync?t=o({kind:0},{equal:e}):t=o({kind:1,value:i?.initialValue},{equal:e});let n=a.subscribe({next:s=>t.set({kind:1,value:s}),error:s=>{if(i?.rejectErrors)throw s;t.set({kind:2,error:s})}});if(i?.requireSync&&t().kind===0)throw new c(601,!1);return r?.onDestroy(n.unsubscribe.bind(n)),g(()=>{let s=t();switch(s.kind){case 1:return s.value;case 2:throw s.error;case 0:throw new c(601,!1)}},{equal:i?.equal})}function C(a=Object.is){return(i,l)=>i.kind===1&&l.kind===1&&a(i.value,l.value)}var O=(()=>{let i=class i{constructor(){this.httpClient=u(p),this.allCars=h(this.getAllCars(),{initialValue:[]}),this.filteredCars=o([]),this.finalCars=this.filteredCars.asReadonly(),this.carBrands=o(["All Brands","Toyota","Ford","Chevrolet","BMW","Tesla","Nissan","Ferrari","Others"]).asReadonly(),this.sortOptions=o([{value:"default",viewValue:"Sort By Default"},{value:"latest",viewValue:"Sort By Latest"},{value:"low",viewValue:"Sort By Low Price"},{value:"high",viewValue:"Sort By High Price"}]).asReadonly(),f(()=>{this.allCars()&&setTimeout(()=>{this.filteredCars.set(this.allCars().sort((r,e)=>e.id>r.id?1:-1))},0)})}getAllCars(){return this.httpClient.get("c/fc8f-f7f2-4c9e-a550")}getCarById(r){return this.allCars().find(e=>e.id===r)}getCarOffers(){return this.httpClient.get("c/4bbf-4125-4467-8ab5")}filtration(r,e,t){this.handleFilterByBrand(t),this.handleSearching(r),this.handleSorting(e)}handleSearching(r){this.filteredCars.update(e=>e.filter(t=>t.name.toLowerCase().includes(r.toLowerCase())))}handleSorting(r){r==="default"?this.defaultSorting():r==="latest"?this.filteredCars.update(e=>e.sort((t,n)=>n.year>t.year?1:-1)):this.filteredCars.update(e=>e.sort((t,n)=>r==="low"?t.price>n.price?1:-1:n.price>t.price?1:-1))}defaultSorting(){this.filteredCars.update(r=>{let e=[];return this.allCars().sort((t,n)=>n.id>t.id?1:-1).forEach(t=>{r.find(n=>n.id===t.id)&&e.push(t)}),e})}handleFilterByBrand(r){if(r.find(e=>e==="All Brands")||r.length===0){this.filteredCars.set(this.allCars());return}this.filteredCars.set(this.allCars().filter(e=>!!r.find(t=>t===e.brand))),r.find(e=>e==="Others")&&this.allCars().forEach(e=>{this.carBrands().find(n=>n===e.brand)||this.filteredCars.update(n=>[...n,e])})}};i.\u0275fac=function(e){return new(e||i)},i.\u0275prov=b({token:i,factory:i.\u0275fac,providedIn:"root"});let a=i;return a})();export{h as a,O as b};
